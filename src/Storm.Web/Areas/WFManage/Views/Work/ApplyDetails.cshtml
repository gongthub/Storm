@{
    ViewBag.Title = "Form";
    Layout = "~/Views/Shared/_Form.cshtml";
}
<script>
    var keyValue = $.request("keyValue");
    var commondefault = [];
    var commonfiles = [];
    $(function () {
        if (!!keyValue) {
            getCommonDefaultValues();
            $.ajax({
                url: "/WFManage/Work/GetFormJson",
                data: { keyValue: keyValue },
                dataType: "json",
                async: false,
                success: function (data) {
                    if (data.Contents != null && data.Contents != undefined && data.Contents != "") {
                        var codeStrs = data.Contents;
                        $("#dvCentents").html(codeStrs);
                        $("#form1").find('.form-control,select,input').attr('disabled', 'disabled');
                        $("#form1").find('div.ckbox label').attr('for', '');
                    }
                }
            });
            getCommonDefaultValues();
            initFiles();
        }
    });
    function getCommonDefaultValues() {
        if (!!keyValue) {
            $.ajax({
                url: "/WFManage/Work/GetWorkFormResJson",
                data: { workId: keyValue },
                dataType: "json",
                async: false,
                success: function (data) {
                    commondefault = data.controls;
                    commonfiles = data.files;
                }
            });
        }
    }
    function initFiles() {
        if (commonfiles != null && commonfiles != undefined && commonfiles.length > 0) {
            for (var i = 0; i < commonfiles.length; i++) {
                var filemodel = commonfiles[i];
                if (filemodel != null && filemodel != undefined) {
                    var fileControl = $("#" + filemodel.ControlId)
                    if (fileControl != null && fileControl != undefined) {
                        var fileShow = "<span><a href='" + filemodel.Paths + "' download='" + filemodel.FullName + "' style='color:red;'>" + filemodel.FullName
                            + "</a><br/></span>";
                        fileControl.after(fileShow);
                    }
                }
            }
            for (var i = 0; i < commonfiles.length; i++) {
                var filemodel = commonfiles[i];
                if (filemodel != null && filemodel != undefined) {
                    var fileControl = $("#" + filemodel.ControlId)
                    $(fileControl).remove();
                }
            }
        }
    }
</script>

<form id="form1">
    <div id="dvCentents" name="dvCentents" style="margin:20px;" class="form">
    </div>
</form>
